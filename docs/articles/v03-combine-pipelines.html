<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Combining pipelines • pipeflow</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Combining pipelines">
<meta name="description" content="Shows how to combine different pipelines to a single pipeline.
">
<meta property="og:description" content="Shows how to combine different pipelines to a single pipeline.
">
<meta property="og:image" content="https://github.com/rpahl/pipeflow/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pipeflow</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="home"><span class="fa fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/v01-get-started.html">Get Started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://rpahl.github.io/r-some-blog/posts/2024-12-21-introducing-pipeflow/">Version 0.2.1</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/index.html">Overview</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Get started</h6></li>
    <li><a class="dropdown-item" href="../articles/v01-get-started.html">Get started with pipeflow</a></li>
    <li><a class="dropdown-item" href="../articles/v02-modify-pipeline.html">Modifying existing pipelines</a></li>
    <li><a class="dropdown-item" href="../articles/v03-combine-pipelines.html">Combining pipelines</a></li>
    <li><a class="dropdown-item" href="../articles/v04-collect-output.html">Collecting pipeline output</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced</h6></li>
    <li><a class="dropdown-item" href="../articles/v05-split-and-combine.html">How to use pipelines with split data sets</a></li>
    <li><a class="dropdown-item" href="../articles/v06-self-modify-pipeline.html">How pipelines can modify themselves at runtime</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-my-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">My Packages</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-my-packages">
<li><a class="external-link dropdown-item" href="https://rpahl.github.io/container/">container</a></li>
    <li><a class="external-link dropdown-item" href="https://rpahl.github.io/GroupSeq/">GroupSeq</a></li>
    <li><a class="external-link dropdown-item" href="https://rpahl.github.io/pipeflow/">pipeflow</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="nav-link" href="https://github.com/rpahl/pipeflow/" aria-label="github"><span class="fa fab fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://stackoverflow.com/users/8120617/rpahl" aria-label="stackoverflow"><span class="fa fab fa-stack-overflow"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://bsky.app/profile/rpahl.bsky.social" aria-label="bluesky"><span class="fa fab fa-bluesky"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://rpahl.github.io/r-some-blog/" aria-label="blog"><span class="fa fas fa-blog"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="v03-combine-pipelines_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="v03-combine-pipelines_files/vis-9.1.0/vis-network.min.css" rel="stylesheet">
<script src="v03-combine-pipelines_files/vis-9.1.0/vis-network.min.js"></script><script src="v03-combine-pipelines_files/visNetwork-binding-2.1.2/visNetwork.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Combining pipelines</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rpahl/pipeflow/blob/HEAD/vignettes/v03-combine-pipelines.Rmd"><code>vignettes/v03-combine-pipelines.Rmd</code></a></small>
      <div class="d-none name"><code>v03-combine-pipelines.Rmd</code></div>
    </div>

    
    
<p>The possibility to combine pipelines basically allows to modularize
the pipeline creation process. This is especially useful when you have a
set of pipelines that are used in different contexts and you want to
avoid code duplication.</p>
<p>In this vignette we will also introduce the pipeflow alias functions,
that is, for each member function of a pipeline, there is an alias
function, which allows to create chain pipeline steps using R’s native
pipe operator <code>|&gt;</code>. For example, the <code>add</code>
function has an alias <code>pipe_add</code> (see below).</p>
<div class="section level3">
<h3 id="define-two-pipelines">Define two pipelines<a class="anchor" aria-label="anchor" href="#define-two-pipelines"></a>
</h3>
<p>Let’s define one pipeline that is used for data_preprocessing and one
that does the modeling.</p>
<p>Data preprocessing pipeline:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">pipeflow</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">pip1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pipe_new.html">pipe_new</a></span><span class="op">(</span></span>
<span>        <span class="st">"preprocessing"</span>,</span>
<span>        data <span class="op">=</span> <span class="va">airquality</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span></span>
<span>    <span class="fu"><a href="../reference/pipe_add.html">pipe_add</a></span><span class="op">(</span></span>
<span>        <span class="st">"data_prep"</span>,</span>
<span>        <span class="kw">function</span><span class="op">(</span><span class="va">data</span> <span class="op">=</span> <span class="op">~</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/replace.html" class="external-link">replace</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"Temp.Celsius"</span>, <span class="op">(</span><span class="va">data</span><span class="op">[</span>, <span class="st">"Temp"</span><span class="op">]</span> <span class="op">-</span> <span class="fl">32</span><span class="op">)</span> <span class="op">*</span> <span class="fl">5</span><span class="op">/</span><span class="fl">9</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span></span>
<span>    <span class="fu"><a href="../reference/pipe_add.html">pipe_add</a></span><span class="op">(</span></span>
<span>        <span class="st">"standardize"</span>,</span>
<span>        <span class="kw">function</span><span class="op">(</span></span>
<span>            <span class="va">data</span> <span class="op">=</span> <span class="op">~</span><span class="va">data_prep</span>,</span>
<span>            <span class="va">yVar</span> <span class="op">=</span> <span class="st">"Ozone"</span></span>
<span>        <span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">data</span><span class="op">[</span>, <span class="va">yVar</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>, <span class="va">yVar</span><span class="op">]</span><span class="op">)</span></span>
<span>            <span class="va">data</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pip1</span></span>
<span><span class="co">#           step   depends    out keepOut       group  state</span></span>
<span><span class="co">#         &lt;char&gt;    &lt;list&gt; &lt;list&gt;  &lt;lgcl&gt;      &lt;char&gt; &lt;char&gt;</span></span>
<span><span class="co"># 1:        data           [NULL]   FALSE        data    New</span></span>
<span><span class="co"># 2:   data_prep      data [NULL]   FALSE   data_prep    New</span></span>
<span><span class="co"># 3: standardize data_prep [NULL]   FALSE standardize    New</span></span></code></pre></div>
<p>Modeling pipeline:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pip2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pipe_new.html">pipe_new</a></span><span class="op">(</span></span>
<span>        <span class="st">"modeling"</span>,</span>
<span>        data <span class="op">=</span> <span class="va">airquality</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span></span>
<span>    <span class="fu"><a href="../reference/pipe_add.html">pipe_add</a></span><span class="op">(</span></span>
<span>        <span class="st">"fit"</span>,</span>
<span>        <span class="kw">function</span><span class="op">(</span></span>
<span>            <span class="va">data</span> <span class="op">=</span> <span class="op">~</span><span class="va">data</span>,</span>
<span>            <span class="va">xVar</span> <span class="op">=</span> <span class="st">"Temp"</span>,</span>
<span>            <span class="va">yVar</span> <span class="op">=</span> <span class="st">"Ozone"</span></span>
<span>        <span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">yVar</span>, <span class="st">"~"</span>, <span class="va">xVar</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span></span>
<span>    <span class="fu"><a href="../reference/pipe_add.html">pipe_add</a></span><span class="op">(</span></span>
<span>        <span class="st">"plot"</span>,</span>
<span>        <span class="kw">function</span><span class="op">(</span></span>
<span>            <span class="va">model</span> <span class="op">=</span> <span class="op">~</span><span class="va">fit</span>,</span>
<span>            <span class="va">data</span> <span class="op">=</span> <span class="op">~</span><span class="va">data</span>,</span>
<span>            <span class="va">xVar</span> <span class="op">=</span> <span class="st">"Temp"</span>,</span>
<span>            <span class="va">yVar</span> <span class="op">=</span> <span class="st">"Ozone"</span>,</span>
<span>            <span class="va">title</span> <span class="op">=</span> <span class="st">"Linear model fit"</span></span>
<span>        <span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">coeffs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coefficients</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">+</span></span>
<span>                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">.data</span><span class="op">[[</span><span class="va">xVar</span><span class="op">]</span><span class="op">]</span>, <span class="va">.data</span><span class="op">[[</span><span class="va">yVar</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="va">coeffs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, slope <span class="op">=</span> <span class="va">coeffs</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="va">title</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pip2</span></span>
<span><span class="co">#      step  depends    out keepOut  group  state</span></span>
<span><span class="co">#    &lt;char&gt;   &lt;list&gt; &lt;list&gt;  &lt;lgcl&gt; &lt;char&gt; &lt;char&gt;</span></span>
<span><span class="co"># 1:   data          [NULL]   FALSE   data    New</span></span>
<span><span class="co"># 2:    fit     data [NULL]   FALSE    fit    New</span></span>
<span><span class="co"># 3:   plot fit,data [NULL]   FALSE   plot    New</span></span></code></pre></div>
<p>Graphically, the two pipelines look as follows:</p>
<div id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:700px;height:100px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"nodes":{"id":[1,2,3],"label":["data","data_prep","standardize"],"group":["data","data_prep","standardize"],"shape":["database","database","box"],"color":["lightblue","lightblue","lightblue"],"title":["<p><\/p>","<p><\/p>","<p><\/p>"]},"edges":{"from":[1,2],"to":[2,3],"arrows":["to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"layout":{"hierarchical":{"enabled":true,"direction":"LR","sortMethod":"directed"}}},"groups":["data","data_prep","standardize"],"width":null,"height":100,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)"},"evals":[],"jsHooks":[]}</script><div id="htmlwidget-e5c8c404fe174e4c81bd" style="width:700px;height:100px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-e5c8c404fe174e4c81bd">{"x":{"nodes":{"id":[1,2,3],"label":["data","fit","plot"],"group":["data","fit","plot"],"shape":["database","box","box"],"color":["lightblue","lightblue","lightblue"],"title":["<p><\/p>","<p><\/p>","<p><\/p>"]},"edges":{"from":[1,1,2],"to":[2,3,3],"arrows":["to","to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"layout":{"hierarchical":{"enabled":true,"direction":"LR","sortMethod":"directed"}}},"groups":["data","fit","plot"],"width":null,"height":100,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="combine-pipelines">Combine pipelines<a class="anchor" aria-label="anchor" href="#combine-pipelines"></a>
</h3>
<p>Next we combine the two pipelines. We can do this by using the
<code>append</code> function.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pip</span> <span class="op">&lt;-</span> <span class="va">pip1</span><span class="op">$</span><span class="fu">append</span><span class="op">(</span><span class="va">pip2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pip</span></span>
<span><span class="co">#             step           depends    out keepOut       group  state</span></span>
<span><span class="co">#           &lt;char&gt;            &lt;list&gt; &lt;list&gt;  &lt;lgcl&gt;      &lt;char&gt; &lt;char&gt;</span></span>
<span><span class="co"># 1:          data                   [NULL]   FALSE        data    New</span></span>
<span><span class="co"># 2:     data_prep              data [NULL]   FALSE   data_prep    New</span></span>
<span><span class="co"># 3:   standardize         data_prep [NULL]   FALSE standardize    New</span></span>
<span><span class="co"># 4: data.modeling                   [NULL]   FALSE        data    New</span></span>
<span><span class="co"># 5:           fit     data.modeling [NULL]   FALSE         fit    New</span></span>
<span><span class="co"># 6:          plot fit,data.modeling [NULL]   FALSE        plot    New</span></span></code></pre></div>
<p>First of all, note that the <code>data</code> step of the second
pipeline has been appended with the name of the second pipeline. In
particular, the first step of the second pipeline has been renamed from
<code>data</code> to <code>data.modeling</code> (line 4 in the
<code>step</code> column) and likewise the dependencies of the second
pipeline have been updated (see lines 5-6 in the <code>depends</code>
column).</p>
<p>That is, when appending two pipelines, <code>pipeflow</code> ensures
that the step names remain unique in the resulting combined pipeline and
therefore automatically renames duplicated step names if necessary.</p>
<p>Now, as can be also seen from the graphical representation of the
pipeline,</p>
<div id="htmlwidget-36aa3d2a04d42bbc2145" style="width:700px;height:250px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-36aa3d2a04d42bbc2145">{"x":{"nodes":{"id":[1,2,3,4,5,6],"label":["data","data_prep","standardize","data.modeling","fit","plot"],"group":["data","data_prep","standardize","data","fit","plot"],"shape":["database","database","box","database","box","box"],"color":["lightblue","lightblue","lightblue","lightblue","lightblue","lightblue"],"title":["<p><\/p>","<p><\/p>","<p><\/p>","<p><\/p>","<p><\/p>","<p><\/p>"]},"edges":{"from":[1,2,4,4,5],"to":[2,3,5,6,6],"arrows":["to","to","to","to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"layout":{"hierarchical":{"enabled":true,"direction":"LR","sortMethod":"directed"}}},"groups":["data","data_prep","standardize","fit","plot"],"width":null,"height":250,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)"},"evals":[],"jsHooks":[]}</script><p>the two pipelines are not yet connected. To make actual use of the
combined pipeline, we therefore want to use the output of the first
pipeline as input of the second pipeline, that is, we want to use the
output of the <code>standardize</code> step as the data parameter input
in the <code>data.modeling</code> step. One way to achieve this would be
to use the <code>replace</code> function as described earlier in the
vignette <a href="v02-modify-pipeline.html">modify the pipeline</a>, for
example:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pip</span><span class="op">$</span><span class="fu">replace_step</span><span class="op">(</span><span class="st">"data.modeling"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">data</span> <span class="op">=</span> <span class="op">~</span><span class="va">standardize</span><span class="op">)</span> <span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pip</span></span>
<span><span class="co">#             step           depends    out keepOut         group    state</span></span>
<span><span class="co">#           &lt;char&gt;            &lt;list&gt; &lt;list&gt;  &lt;lgcl&gt;        &lt;char&gt;   &lt;char&gt;</span></span>
<span><span class="co"># 1:          data                   [NULL]   FALSE          data      New</span></span>
<span><span class="co"># 2:     data_prep              data [NULL]   FALSE     data_prep      New</span></span>
<span><span class="co"># 3:   standardize         data_prep [NULL]   FALSE   standardize      New</span></span>
<span><span class="co"># 4: data.modeling       standardize [NULL]   FALSE data.modeling      New</span></span>
<span><span class="co"># 5:           fit     data.modeling [NULL]   FALSE           fit Outdated</span></span>
<span><span class="co"># 6:          plot fit,data.modeling [NULL]   FALSE          plot Outdated</span></span></code></pre></div>
<div id="htmlwidget-febe03efa1a2d8d52a86" style="width:700px;height:100px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-febe03efa1a2d8d52a86">{"x":{"nodes":{"id":[1,2,3,4,5,6],"label":["data","data_prep","standardize","data.modeling","fit","plot"],"group":["data","data_prep","standardize","data.modeling","fit","plot"],"shape":["database","database","box","database","box","box"],"color":["lightblue","lightblue","lightblue","lightblue","orange","orange"],"title":["<p><\/p>","<p><\/p>","<p><\/p>","<p><\/p>","<p><\/p>","<p><\/p>"]},"edges":{"from":[1,2,3,4,4,5],"to":[2,3,4,5,6,6],"arrows":["to","to","to","to","to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"layout":{"hierarchical":{"enabled":true,"direction":"LR","sortMethod":"directed"}}},"groups":["data","data_prep","standardize","data.modeling","fit","plot"],"width":null,"height":100,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)"},"evals":[],"jsHooks":[]}</script><div class="section level4">
<h4 id="relative-indexing">Relative indexing<a class="anchor" aria-label="anchor" href="#relative-indexing"></a>
</h4>
<p>Since the name of the last step might not always be known<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;A typical example would be appending several pipelines
in a programmatic context.&lt;/p&gt;"><sup>1</sup></a>, the
<code>pipeflow</code> package also provides a relative position indexing
mechanism, which allows to rewrite the above command as follows:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pip</span><span class="op">$</span><span class="fu">replace_step</span><span class="op">(</span><span class="st">"data.modeling"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">data</span> <span class="op">=</span> <span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pip</span></span>
<span><span class="co">#             step           depends    out keepOut         group    state</span></span>
<span><span class="co">#           &lt;char&gt;            &lt;list&gt; &lt;list&gt;  &lt;lgcl&gt;        &lt;char&gt;   &lt;char&gt;</span></span>
<span><span class="co"># 1:          data                   [NULL]   FALSE          data      New</span></span>
<span><span class="co"># 2:     data_prep              data [NULL]   FALSE     data_prep      New</span></span>
<span><span class="co"># 3:   standardize         data_prep [NULL]   FALSE   standardize      New</span></span>
<span><span class="co"># 4: data.modeling       standardize [NULL]   FALSE data.modeling      New</span></span>
<span><span class="co"># 5:           fit     data.modeling [NULL]   FALSE           fit Outdated</span></span>
<span><span class="co"># 6:          plot fit,data.modeling [NULL]   FALSE          plot Outdated</span></span></code></pre></div>
<p>Generally speaking, the relative indexing mechanism allows to refer
to steps positioned above the current step. The index <code>~-1</code>
can be interpreted as “go one step back”, <code>~-2</code> as “go two
steps back”, and so on.</p>
<p>Since the scenario of connecting two pipelines is so common and to
avoid having to do the above replacement steps manually, the
<code>append</code> function actually provides an argument
<code>outAsIn</code> that allows for appending and “connecting” both
pipelines in one go:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pip</span> <span class="op">&lt;-</span> <span class="va">pip1</span><span class="op">$</span><span class="fu">append</span><span class="op">(</span><span class="va">pip2</span>, outAsIn <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pip</span></span>
<span><span class="co">#             step           depends    out keepOut         group    state</span></span>
<span><span class="co">#           &lt;char&gt;            &lt;list&gt; &lt;list&gt;  &lt;lgcl&gt;        &lt;char&gt;   &lt;char&gt;</span></span>
<span><span class="co"># 1:          data                   [NULL]   FALSE          data      New</span></span>
<span><span class="co"># 2:     data_prep              data [NULL]   FALSE     data_prep      New</span></span>
<span><span class="co"># 3:   standardize         data_prep [NULL]   FALSE   standardize      New</span></span>
<span><span class="co"># 4: data.modeling       standardize [NULL]   FALSE data.modeling      New</span></span>
<span><span class="co"># 5:           fit     data.modeling [NULL]   FALSE           fit Outdated</span></span>
<span><span class="co"># 6:          plot fit,data.modeling [NULL]   FALSE          plot Outdated</span></span></code></pre></div>
<div id="htmlwidget-1fb4450895fe099f74a1" style="width:700px;height:100px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-1fb4450895fe099f74a1">{"x":{"nodes":{"id":[1,2,3,4,5,6],"label":["data","data_prep","standardize","data.modeling","fit","plot"],"group":["data","data_prep","standardize","data.modeling","fit","plot"],"shape":["database","database","box","database","box","box"],"color":["lightblue","lightblue","lightblue","lightblue","orange","orange"],"title":["<p><\/p>","<p><\/p>","<p><\/p>","<p>output of last step of first pipeline<\/p>","<p><\/p>","<p><\/p>"]},"edges":{"from":[1,2,3,4,4,5],"to":[2,3,4,5,6,6],"arrows":["to","to","to","to","to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"layout":{"hierarchical":{"enabled":true,"direction":"LR","sortMethod":"directed"}}},"groups":["data","data_prep","standardize","data.modeling","fit","plot"],"width":null,"height":100,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)"},"evals":[],"jsHooks":[]}</script><p>If we inspect the <code>data.modeling</code> step, we see that “under
the hood” the original step indeed has been replaced by the output of
the last step of the first pipeline using the same relative indexing
mechanism we did manually before.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pip</span><span class="op">$</span><span class="fu">get_step</span><span class="op">(</span><span class="st">"data.modeling"</span><span class="op">)</span><span class="op">[[</span><span class="st">"fun"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co"># [[1]]</span></span>
<span><span class="co"># function (data = ~-1) </span></span>
<span><span class="co"># data</span></span>
<span><span class="co"># &lt;bytecode: 0x000002309e0291b0&gt;</span></span>
<span><span class="co"># &lt;environment: 0x000002309b395698&gt;</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="run-combined-pipeline">Run combined pipeline<a class="anchor" aria-label="anchor" href="#run-combined-pipeline"></a>
</h3>
<p>Let’s now run the combined pipeline and inspect the plot.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pip</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># INFO  [2024-12-22 15:47:01.770] Start run of 'preprocessing.modeling' pipeline:</span></span>
<span><span class="co"># INFO  [2024-12-22 15:47:01.818] Step 1/6 data</span></span>
<span><span class="co"># INFO  [2024-12-22 15:47:01.827] Step 2/6 data_prep</span></span>
<span><span class="co"># INFO  [2024-12-22 15:47:01.846] Step 3/6 standardize</span></span>
<span><span class="co"># INFO  [2024-12-22 15:47:01.849] Step 4/6 data.modeling</span></span>
<span><span class="co"># INFO  [2024-12-22 15:47:01.851] Step 5/6 fit</span></span>
<span><span class="co"># INFO  [2024-12-22 15:47:01.855] Step 6/6 plot</span></span>
<span><span class="co"># INFO  [2024-12-22 15:47:01.866] Finished execution of steps.</span></span>
<span><span class="co"># INFO  [2024-12-22 15:47:01.866] Done.</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pip</span><span class="op">$</span><span class="fu">get_out</span><span class="op">(</span><span class="st">"plot"</span><span class="op">)</span></span>
<span><span class="co"># Warning: Removed 37 rows containing missing values or values outside the scale range</span></span>
<span><span class="co"># (`geom_point()`).</span></span></code></pre></div>
<p><img src="v03-combine-pipelines_files/figure-html/unnamed-chunk-14-1.png" alt="model-plot" width="700"></p>
<p>As we can see, the plot shows the linear model fit using the
standardized data. We can now go ahead and for example change the
x-variable of the model and rerun the pipeline.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pip</span><span class="op">$</span><span class="fu">set_params</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>xVar <span class="op">=</span> <span class="st">"Temp.Celsius"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-10b3b7155e8045a1b2ad" style="width:700px;height:100px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-10b3b7155e8045a1b2ad">{"x":{"nodes":{"id":[1,2,3,4,5,6],"label":["data","data_prep","standardize","data.modeling","fit","plot"],"group":["data","data_prep","standardize","data.modeling","fit","plot"],"shape":["database","database","box","database","box","box"],"color":["lightgreen","lightgreen","lightgreen","lightgreen","orange","orange"],"title":["<p><\/p>","<p><\/p>","<p><\/p>","<p>output of last step of first pipeline<\/p>","<p><\/p>","<p><\/p>"]},"edges":{"from":[1,2,3,4,4,5],"to":[2,3,4,5,6,6],"arrows":["to","to","to","to","to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"layout":{"hierarchical":{"enabled":true,"direction":"LR","sortMethod":"directed"}}},"groups":["data","data_prep","standardize","data.modeling","fit","plot"],"width":null,"height":100,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)"},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pip</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># INFO  [2024-12-22 15:47:02.471] Start run of 'preprocessing.modeling' pipeline:</span></span>
<span><span class="co"># INFO  [2024-12-22 15:47:02.472] Step 1/6 data - skip 'done' step</span></span>
<span><span class="co"># INFO  [2024-12-22 15:47:02.473] Step 2/6 data_prep - skip 'done' step</span></span>
<span><span class="co"># INFO  [2024-12-22 15:47:02.474] Step 3/6 standardize - skip 'done' step</span></span>
<span><span class="co"># INFO  [2024-12-22 15:47:02.475] Step 4/6 data.modeling - skip 'done' step</span></span>
<span><span class="co"># INFO  [2024-12-22 15:47:02.476] Step 5/6 fit</span></span>
<span><span class="co"># INFO  [2024-12-22 15:47:02.481] Step 6/6 plot</span></span>
<span><span class="co"># INFO  [2024-12-22 15:47:02.492] Finished execution of steps.</span></span>
<span><span class="co"># INFO  [2024-12-22 15:47:02.493] Done.</span></span></code></pre></div>
<div id="htmlwidget-4018eef1a407a0df6b52" style="width:700px;height:100px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-4018eef1a407a0df6b52">{"x":{"nodes":{"id":[1,2,3,4,5,6],"label":["data","data_prep","standardize","data.modeling","fit","plot"],"group":["data","data_prep","standardize","data.modeling","fit","plot"],"shape":["database","database","box","database","box","box"],"color":["lightgreen","lightgreen","lightgreen","lightgreen","lightgreen","lightgreen"],"title":["<p><\/p>","<p><\/p>","<p><\/p>","<p>output of last step of first pipeline<\/p>","<p><\/p>","<p><\/p>"]},"edges":{"from":[1,2,3,4,4,5],"to":[2,3,4,5,6,6],"arrows":["to","to","to","to","to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"layout":{"hierarchical":{"enabled":true,"direction":"LR","sortMethod":"directed"}}},"groups":["data","data_prep","standardize","data.modeling","fit","plot"],"width":null,"height":100,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)"},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pip</span><span class="op">$</span><span class="fu">get_out</span><span class="op">(</span><span class="st">"plot"</span><span class="op">)</span></span>
<span><span class="co"># Warning: Removed 37 rows containing missing values or values outside the scale range</span></span>
<span><span class="co"># (`geom_point()`).</span></span></code></pre></div>
<p><img src="v03-combine-pipelines_files/figure-html/unnamed-chunk-19-1.png" alt="model-plot" width="700"></p>
<p>When creating these pipelines, usually there will be a lot of steps
calculating intermediate results and only a few steps contain the final
results that we are interested in. In the above example, we were
interested in the final plot output. In a real-world scenario, the
pipeline would contain many more steps that are not of interest to us.
To see how to conveniently tag, collect and possibly group the output of
those final steps, see the next vignette <a href="v04-collect-output.html">Collecting output</a>.</p>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://rpahl.github.io/r-some-blog/about.html" class="external-link">Roman Pahl</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
